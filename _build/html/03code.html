
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The code &#8212; Polynomial Chaos better and faster</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Bibliography" href="bibliography.html" />
    <link rel="prev" title="The alpha matrix: dealing with multivariate polynomials" href="02indexMatrix.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Polynomial Chaos better and faster</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Polynomial Chaos Expansion: better and faster
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01coefficients.html">
   How the coefficients are calculated
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02indexMatrix.html">
   The alpha matrix: dealing with multivariate polynomials
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   The code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/03code.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F03code.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/03code.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-and-basic-structure">
   Introduction and basic structure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-alpha-matrix">
   The alpha Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-coefficients-and-the-library">
   The coefficients and the Library
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The code</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-and-basic-structure">
   Introduction and basic structure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-alpha-matrix">
   The alpha Matrix
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-coefficients-and-the-library">
   The coefficients and the Library
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="the-code">
<h1>The code<a class="headerlink" href="#the-code" title="Permalink to this headline">#</a></h1>
<section id="introduction-and-basic-structure">
<h2>Introduction and basic structure<a class="headerlink" href="#introduction-and-basic-structure" title="Permalink to this headline">#</a></h2>
<p>The main objective of this code is to implement the strategy presented in the previous sections to generate a library for SINDy. In order to do so the final output needs to be a list of callable functions.</p>
<p>In order to keep the code as tidy as possible the computation of the coefficients and that of the alpha matrix have been separated in two different modules.</p>
<p>The main functionality of the codes are nothing more than a translation from matlab to python of the arbitrary Polynomial Chaos code (aPC) created by Oladyshkin <span id="id1">[<a class="reference internal" href="bibliography.html#id3" title="Sergey Oladyshkin. Apc matlab toolbox: data-driven arbitrary polynomial chaos. Retrieved June 13, 2022. URL: https://www.mathworks.com/matlabcentral/fileexchange/72014-apc-matlab-toolbox-data-driven-arbitrary-polynomial-chaos.">Ola</a>]</span>. The part that generates the list of functions has been, instead, written from scratch.</p>
</section>
<section id="the-alpha-matrix">
<h2>The alpha Matrix<a class="headerlink" href="#the-alpha-matrix" title="Permalink to this headline">#</a></h2>
<p>This first part of the code outputs the alpha matrix given the maximum degree of the expansion and the number of variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">factorial</span>

<span class="k">def</span> <span class="nf">MultivariatePolynomialIndex</span><span class="p">(</span>
        <span class="n">N</span><span class="p">,</span> <span class="c1"># number of variables</span>
        <span class="n">d</span>  <span class="c1"># degree of the polynomial expansion </span>
        <span class="p">):</span>
    <span class="n">M</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span> <span class="c1"># total number of inputs</span>
    
    <span class="n">PossibleDegree</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">UniqueDegreeCombinations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="n">PossibleDegree</span><span class="p">))</span>
    <span class="n">UniqueDegreeCombinations</span> <span class="o">=</span> <span class="n">UniqueDegreeCombinations</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">UniqueDegreeCombinations</span> <span class="o">=</span> <span class="n">UniqueDegreeCombinations</span><span class="o">.</span><span class="n">T</span>
    
    <span class="n">DegreeWeight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">UniqueDegreeCombinations</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">UniqueDegreeCombinations</span><span class="p">)):</span>
        <span class="n">DegreeWeight</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">UniqueDegreeCombinations</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
            
    <span class="n">ID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">DegreeWeight</span><span class="p">)</span>
    <span class="n">SortDegreeCombination</span> <span class="o">=</span> <span class="n">UniqueDegreeCombinations</span><span class="p">[</span><span class="n">ID</span><span class="p">,:]</span>
    
    <span class="k">return</span> <span class="n">SortDegreeCombination</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">M</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
</div>
<p>As an example the matrix for the 2-2 case, presented before, is calculated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># maximum degree of the expansion</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># number of variables</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="n">MultivariatePolynomialIndex</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0 0]
 [1 0]
 [0 1]
 [2 0]
 [1 1]
 [0 2]]
</pre></div>
</div>
</div>
</div>
<p>It has to be noted that a diffierence in the construction of the <code class="docutils literal notranslate"><span class="pre">UniqueDegreeCombinations</span></code> matrix has as a result a sligthly different ordering of the indices with respect to the original code. However, it doesn’t effect the role of the matrix in the final expansion.</p>
</section>
<section id="the-coefficients-and-the-library">
<h2>The coefficients and the Library<a class="headerlink" href="#the-coefficients-and-the-library" title="Permalink to this headline">#</a></h2>
<p>The main part of the code computes the coefficients of the expansion and output the list of functions to be transformed in a SINDy library.</p>
<p>The main class of the code deals with the calculation of the coefficients and uses the previous code to compute the alpha matrix. This informations are enough to fully characterize the expansion. The last function can take this data and output the desired function list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>

<span class="k">class</span> <span class="nc">PolynomialChaos</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Basic class for the Polynomial Chaos Expansion</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                 <span class="n">distribution</span><span class="p">,</span>
                 <span class="n">expansionDegree</span><span class="p">,</span>
                 <span class="n">numberOfInputs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expansionDegree</span> <span class="o">=</span> <span class="n">expansionDegree</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numberOfInputs</span> <span class="o">=</span> <span class="n">numberOfInputs</span>
        
    <span class="k">def</span> <span class="nf">ComputeMoments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution_1D</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Compute the statistical moments of a distribution (1D) up to the </span>
<span class="sd">        2*expansionDegree (2*expansionDegree-1 would be sufficient, the last </span>
<span class="sd">        could be useful for a furteher versions that implement normalization in </span>
<span class="sd">        order to have orthonormal base)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">numberOfSamples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">distribution_1D</span><span class="p">)</span>
        <span class="n">DistributionMoments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">distribution_1D</span><span class="o">**</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">numberOfSamples</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">expansionDegree</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">DistributionMoments</span>
        
    <span class="k">def</span> <span class="nf">MomentMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution_1D</span><span class="p">,</span> <span class="n">polynomialDegree</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate the moment matrix to compute the coefficients for a polynomial </span>
<span class="sd">        of degree polynomialDegree, as explained in the reference paper [1]</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">polynomialDegree</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">Hankel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">d</span><span class="p">,</span><span class="n">d</span><span class="p">))</span> <span class="c1"># moments matrix initialization</span>
        <span class="n">moments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ComputeMoments</span><span class="p">(</span><span class="n">distribution_1D</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">polynomialDegree</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">polynomialDegree</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">polynomialDegree</span><span class="p">:</span>
                    <span class="n">Hankel</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">moments</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Hankel</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">Hankel</span>
    
    <span class="k">def</span> <span class="nf">aPC_OneDimensional</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distribution_1D</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes and returns the coefficient matrix for a 1D distribution from the 0-degree</span>
<span class="sd">        polynomial up to the one of degree expansionDegree.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansionDegree</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">d</span><span class="p">,</span><span class="n">d</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MomentMatrix</span><span class="p">(</span><span class="n">distribution_1D</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">coefficients</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
        <span class="c1"># coefficients = np.reshape(coefficients,(d,d,1))</span>
        <span class="k">return</span> <span class="n">coefficients</span>

    <span class="k">def</span> <span class="nf">ComputeCoefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the coefficient for the PC expansion (in general multidimensional).</span>
<span class="sd">        Makes use of the MultivariatePolynomialsIndex function to generate the </span>
<span class="sd">        Alpha matrix useful for the construction of the base.</span>
<span class="sd">        The coefficient tensor and the Alpha matrix are enough to fully characterize</span>
<span class="sd">        the PC expansion</span>
<span class="sd">        </span>
<span class="sd">        The coefficient tensor has three dimensions, as:</span>
<span class="sd">            - the first represents the order of the sigle term (from 0 to expansionDegree)</span>
<span class="sd">            - the second the total degree of the polynomial (from 0 to expansionDegree)</span>
<span class="sd">            - the third the variable (from 1 to numberOfInputs)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansionDegree</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">numberOfInputs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aPC_OneDimensional</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">),</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AlphaMatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">d</span><span class="p">,</span><span class="n">d</span><span class="p">,</span> <span class="n">numberOfInputs</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numberOfInputs</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span><span class="p">[:,:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aPC_OneDimensional</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AlphaMatrix</span> <span class="o">=</span> <span class="n">MultivariatePolynomialIndex</span><span class="p">(</span><span class="n">numberOfInputs</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            
<span class="k">def</span> <span class="nf">GenerateLibraryList</span><span class="p">(</span>
        <span class="n">expansionDegree</span><span class="p">,</span>
        <span class="n">coefficients</span><span class="p">,</span>
        <span class="n">AlphaMatrix</span>
        <span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Given the Alpha matrix and the coefficient tensor conputes a list of functions</span>
<span class="sd">    ready to be transformed into a SINDy library.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">M</span> <span class="p">,</span> <span class="n">numberOfInputs</span> <span class="o">=</span> <span class="n">AlphaMatrix</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># M = total number of terms in the expansion</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numberOfInputs</span><span class="p">):</span> <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span> <span class="c1"># list of symbolic variables</span>
    <span class="n">LibraryList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span> <span class="c1"># order</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">AlphaMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
        <span class="n">MultivariatePolynomial</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numberOfInputs</span><span class="p">):</span> <span class="c1"># variable</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="n">coefficients</span><span class="p">[:,</span> <span class="n">index</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> 
            <span class="n">coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="c1"># The MultivariatePolynomials function gives the coefficients from 0 to max_deg, while Poly starts from max_deg and goes to 0</span>
            <span class="n">Polynomial1D</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Poly</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">MultivariatePolynomial</span> <span class="o">=</span> <span class="n">MultivariatePolynomial</span> <span class="o">*</span> <span class="n">Polynomial1D</span> <span class="c1"># multivaried polynomial object</span>
            <span class="n">MultivariatePolynomial</span> <span class="o">=</span> <span class="n">MultivariatePolynomial</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span> 
            
        <span class="n">LibraryList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">MultivariatePolynomial</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">LibraryList</span>
        
</pre></div>
</div>
</div>
</div>
<p>As an example, the coefficients for the Legendre polynomials are calculated from an evely distributed <span class="math notranslate nohighlight">\(x\)</span> over <span class="math notranslate nohighlight">\(\mathcal X \in [-1,1]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of samples</span>
<span class="n">data_uniform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">data_uniform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">data_uniform</span><span class="p">])</span> <span class="c1"># to have the correct shape</span>

<span class="n">expansionDegree</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">numberOfInputs</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">aPC</span> <span class="o">=</span> <span class="n">PolynomialChaos</span><span class="p">(</span><span class="n">data_uniform</span><span class="p">,</span> <span class="n">expansionDegree</span><span class="p">,</span> <span class="n">numberOfInputs</span><span class="p">)</span>
<span class="n">aPC</span><span class="o">.</span><span class="n">ComputeCoefficients</span><span class="p">()</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">aPC</span><span class="o">.</span><span class="n">coefficients</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">aPC</span><span class="o">.</span><span class="n">AlphaMatrix</span>

<span class="n">LibraryList</span> <span class="o">=</span> <span class="n">GenerateLibraryList</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">coefficients</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_uniform</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">LibraryList</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">data_uniform</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;deg = 1&#39;</span><span class="p">,</span><span class="s1">&#39;deg = 2&#39;</span><span class="p">,</span><span class="s1">&#39;deg = 3&#39;</span><span class="p">,</span><span class="s1">&#39;deg = 4&#39;</span><span class="p">,</span><span class="s1">&#39;deg = 5&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Legendre Polynomials&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  1.00000000e+00  0.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-3.34000667e-01  4.25473842e-17  1.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 1.07645630e-17 -6.01200400e-01  1.03182181e-17  1.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 8.60571411e-02 -2.32657687e-16 -8.58855996e-01  3.96977440e-16
   1.00000000e+00  0.00000000e+00]
 [-1.36824296e-16  2.39046339e-01  1.10289390e-15 -1.11332888e+00
  -1.16111530e-15  1.00000000e+00]]
</pre></div>
</div>
<img alt="_images/03code_10_1.png" src="_images/03code_10_1.png" />
</div>
</div>
<p>Note that the coefficient are the same as the classical ones up to a multiplicative constant, since the original Legendre polynomials are meant to be equal to <span class="math notranslate nohighlight">\(\pm1\)</span> for <span class="math notranslate nohighlight">\(x=\pm1\)</span></p>
<p>As a proof of concept a second variable following a gaussian distribution will be added. This one should generate Hermite Polynomials. The overall expansion will have 2 variables polynomials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<span class="n">data_gaussian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data_gaussian</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_uniform</span>
<span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_gaussian</span>

<span class="n">numberOfInputs</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">aPC</span> <span class="o">=</span> <span class="n">PolynomialChaos</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">expansionDegree</span><span class="p">,</span> <span class="n">numberOfInputs</span><span class="p">)</span>
<span class="n">aPC</span><span class="o">.</span><span class="n">ComputeCoefficients</span><span class="p">()</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">aPC</span><span class="o">.</span><span class="n">coefficients</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">aPC</span><span class="o">.</span><span class="n">AlphaMatrix</span>

<span class="n">LibraryList</span> <span class="o">=</span> <span class="n">GenerateLibraryList</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>

<span class="c1"># FIGURES</span>

<span class="n">x_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data_gaussian</span><span class="p">)</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data_gaussian</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">data_uniform</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span><span class="n">x_max</span><span class="p">,</span><span class="n">n</span><span class="p">))</span> 
<span class="n">Z</span> <span class="o">=</span> <span class="n">LibraryList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">](</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;3d&quot;</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x uniform&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x gaussian&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Polynomial </span><span class="si">{</span><span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All terms in the expansion:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/03code_12_0.png" src="_images/03code_12_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All terms in the expansion:
[[0 0]
 [1 0]
 [0 1]
 [2 0]
 [0 2]
 [1 1]
 [0 3]
 [2 1]
 [1 2]
 [3 0]
 [3 1]
 [0 4]
 [4 0]
 [2 2]
 [1 3]
 [4 1]
 [1 4]
 [3 2]
 [0 5]
 [5 0]
 [2 3]]
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="02indexMatrix.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">The alpha matrix: dealing with multivariate polynomials</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="bibliography.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Bibliography</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Enrico Foglia<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>